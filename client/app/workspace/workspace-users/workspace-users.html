<div class="workspace-users-wrapper">
    <div
      class="action-message"
      ng-class="{
        'text-success': (vm.actionMessageColor === 'success'),
        'text-danger': (vm.actionMessageColor === 'danger')
      }"
      ng-if="vm.actionMessage"
    >
      {{ vm.actionMessage }}
    </div>

    <section class="workspace-users">
      <h3 class="mb-2">Workspace Users</h3>
      <div class="workspace-users-table mb-5">
        <div class="table-row header">
          <div class="cell">
            Username
          </div>
          <div class="cell">
            Email
          </div>
          <div class="cell">
            Owner
          </div>
          <div class="cell">
            Permission
          </div>
          <div class="cell">
            Action
          </div>
        </div>

        <div class="table-row" ng-repeat="user in vm.users | orderBy:'username'">
          <div class="cell username" data-title="Username">
            {{ user.username }}
          </div>
          <div class="cell email" data-title="Email" ng-attr-title="{{ user.email }}">
            {{ user.email }}
          </div>
          <div class="cell owner" data-title="Owner">
            <span class="badge badge-success" ng-if="user.UserWorkspace.is_owner">YES</span>
            <span class="badge badge-danger" ng-if="!user.UserWorkspace.is_owner">NO</span>
          </div>
          <div class="cell owner" data-title="Permission">
            <span class="badge badge-success" ng-if="user.UserWorkspace.permission === 'admin'">admin</span>
            <span class="badge badge-primary" ng-if="user.UserWorkspace.permission === 'ro'">write</span>
            <span class="badge badge-secondary" ng-if="user.UserWorkspace.permission === 'ro'">read</span>
            <span class="badge badge-danger" ng-if="!user.UserWorkspace">NONE</span>
          </div>
          <div
            class="cell action"
            ng-class="{'current-user': user._id === vm.principal._id}"
            data-title="Action"
          >
            <div class="dropdown d-inline-block">
              <div class="dropdown-button" data-toggle="dropdown">
                <i class="fa fa-angle-down"></i>
              </div>
              <div class="dropdown-menu">
                <nav class="nav nav-style-2 flex-column">
                  <div class="nav-link" ng-show="!user.FireDepartment" ng-click="vm.approveAccess(user)">
                    <i class="fa fa-2x fa-check-circle"></i>
                    <span>Approve Dashboard Admin</span>
                  </div>
                  <div class="nav-link"  ng-show="!user.FireDepartment" ng-click="vm.approveAccess(user, true)">
                    <i class="fa fa-2x fa-check-circle"></i>
                    <span>Approve Dashboard Readonly</span>
                  </div>
                  <div class="nav-link" ng-show="!user.isDepartmentAdmin && !user.isIngest" ng-click="vm.revokeAccess(user)">
                    <i class="fa fa-2x fa-times-circle"></i>
                    <span>Revoke Access</span>
                  </div>
                </nav>
              </div><!-- dropdown-menu -->
            </div><!-- dropdown -->
          </div>
        </div>
      </div>
    </section>
  </div>
